[2025-10-05 08:38:13,177][__main__][INFO] - Initializing pipeline
[2025-10-05 08:38:13,178][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 08:38:13,181][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule
[2025-10-05 08:38:13,182][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF
[2025-10-05 08:38:13,183][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\disc_model_MLPClassifier.pt
[2025-10-05 08:38:13,183][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 08:38:13,184][__main__][INFO] - Loading dataset
[2025-10-05 08:38:13,708][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 08:38:13,710][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_0
[2025-10-05 08:38:13,710][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_0
[2025-10-05 08:38:13,711][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_0\disc_model_MLPClassifier.pt
[2025-10-05 08:38:13,713][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_0\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 08:38:13,714][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 08:38:13,788][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 08:38:15,274][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 08:38:15,393][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.8888888888888888, 'recall': 0.8888888888888888, 'f1-score': 0.8888888888888888, 'support': 9.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.9090909090909091, 'f1-score': 0.9090909090909091, 'support': 11.0}, 'accuracy': 0.9, 'macro avg': {'precision': 0.898989898989899, 'recall': 0.898989898989899, 'f1-score': 0.898989898989899, 'support': 20.0}, 'weighted avg': {'precision': 0.9, 'recall': 0.9, 'f1-score': 0.9, 'support': 20.0}}
[2025-10-05 08:38:15,483][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 08:38:15,543][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 08:38:15,544][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:15,546][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:15,636][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 08:38:15,672][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 08:38:15,672][__main__][INFO] - Creating counterfactual model
[2025-10-05 08:38:15,685][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 08:38:16,518][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 08:38:16,518][__main__][INFO] - Handling counterfactual generation
[2025-10-05 08:38:17,024][__main__][INFO] - Counterfactual search time: 0.5031 seconds
[2025-10-05 08:38:17,029][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_0\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 08:38:17,108][__main__][INFO] - Calculating metrics
[2025-10-05 08:38:17,112][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:17,112][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:17,117][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:17,118][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:17,119][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:17,120][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:17,121][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:17,122][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:17,122][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:17,123][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:17,123][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:17,123][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:17,123][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:17,123][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:17,124][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:17,125][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:17,126][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:17,127][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:17,127][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:17,128][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:17,130][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:19,125][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 08:38:19,127][__main__][INFO] - Metrics for fold 0: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 08:38:19,199][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 08:38:19,201][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_1
[2025-10-05 08:38:19,202][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_1
[2025-10-05 08:38:19,203][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_1\disc_model_MLPClassifier.pt
[2025-10-05 08:38:19,203][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_1\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 08:38:19,204][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 08:38:19,216][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 08:38:19,248][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 08:38:19,307][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.7777777777777778, 'recall': 0.875, 'f1-score': 0.8235294117647058, 'support': 8.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.8333333333333334, 'f1-score': 0.8695652173913043, 'support': 12.0}, 'accuracy': 0.85, 'macro avg': {'precision': 0.8434343434343434, 'recall': 0.8541666666666667, 'f1-score': 0.8465473145780051, 'support': 20.0}, 'weighted avg': {'precision': 0.8565656565656565, 'recall': 0.85, 'f1-score': 0.851150895140665, 'support': 20.0}}
[2025-10-05 08:38:19,392][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 08:38:19,449][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 08:38:19,450][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:19,451][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:19,486][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 08:38:19,517][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 08:38:19,519][__main__][INFO] - Creating counterfactual model
[2025-10-05 08:38:19,522][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 08:38:20,284][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 08:38:20,285][__main__][INFO] - Handling counterfactual generation
[2025-10-05 08:38:20,686][__main__][INFO] - Counterfactual search time: 0.4009 seconds
[2025-10-05 08:38:20,692][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_1\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 08:38:20,768][__main__][INFO] - Calculating metrics
[2025-10-05 08:38:20,772][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:20,773][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:20,774][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:20,774][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:20,775][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:20,777][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:20,777][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:20,778][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:20,778][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:20,780][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:20,780][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:20,781][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:20,782][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:20,782][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:20,783][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:20,784][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:20,784][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:20,784][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:20,785][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:20,786][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:20,787][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:22,730][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 08:38:22,730][__main__][INFO] - Metrics for fold 1: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 08:38:22,797][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 08:38:22,799][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_2
[2025-10-05 08:38:22,801][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_2
[2025-10-05 08:38:22,802][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_2\disc_model_MLPClassifier.pt
[2025-10-05 08:38:22,804][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_2\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 08:38:22,805][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 08:38:22,819][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 08:38:22,848][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 08:38:22,907][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.7777777777777778, 'recall': 0.875, 'f1-score': 0.8235294117647058, 'support': 8.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.8333333333333334, 'f1-score': 0.8695652173913043, 'support': 12.0}, 'accuracy': 0.85, 'macro avg': {'precision': 0.8434343434343434, 'recall': 0.8541666666666667, 'f1-score': 0.8465473145780051, 'support': 20.0}, 'weighted avg': {'precision': 0.8565656565656565, 'recall': 0.85, 'f1-score': 0.851150895140665, 'support': 20.0}}
[2025-10-05 08:38:22,993][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 08:38:23,052][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 08:38:23,053][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:23,054][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:23,089][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 08:38:23,124][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 08:38:23,125][__main__][INFO] - Creating counterfactual model
[2025-10-05 08:38:23,129][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 08:38:23,820][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 08:38:23,820][__main__][INFO] - Handling counterfactual generation
[2025-10-05 08:38:24,206][__main__][INFO] - Counterfactual search time: 0.3852 seconds
[2025-10-05 08:38:24,214][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_2\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 08:38:24,292][__main__][INFO] - Calculating metrics
[2025-10-05 08:38:24,294][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:24,294][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:24,296][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:24,297][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:24,298][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:24,299][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:24,299][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:24,300][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:24,301][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:24,302][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:24,302][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:24,303][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:24,304][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:24,305][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:24,307][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:24,308][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:24,309][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:24,310][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:24,311][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:24,311][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:24,312][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:26,342][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 08:38:26,343][__main__][INFO] - Metrics for fold 2: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 08:38:26,405][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 08:38:26,408][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_3
[2025-10-05 08:38:26,410][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_3
[2025-10-05 08:38:26,411][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_3\disc_model_MLPClassifier.pt
[2025-10-05 08:38:26,412][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_3\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 08:38:26,413][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 08:38:26,428][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 08:38:26,455][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 08:38:26,509][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.7777777777777778, 'recall': 0.875, 'f1-score': 0.8235294117647058, 'support': 8.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.8333333333333334, 'f1-score': 0.8695652173913043, 'support': 12.0}, 'accuracy': 0.85, 'macro avg': {'precision': 0.8434343434343434, 'recall': 0.8541666666666667, 'f1-score': 0.8465473145780051, 'support': 20.0}, 'weighted avg': {'precision': 0.8565656565656565, 'recall': 0.85, 'f1-score': 0.851150895140665, 'support': 20.0}}
[2025-10-05 08:38:26,584][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 08:38:26,641][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 08:38:26,642][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:26,643][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:26,678][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 08:38:26,710][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 08:38:26,710][__main__][INFO] - Creating counterfactual model
[2025-10-05 08:38:26,714][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 08:38:27,458][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 08:38:27,459][__main__][INFO] - Handling counterfactual generation
[2025-10-05 08:38:27,811][__main__][INFO] - Counterfactual search time: 0.3505 seconds
[2025-10-05 08:38:27,817][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_3\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 08:38:27,894][__main__][INFO] - Calculating metrics
[2025-10-05 08:38:27,897][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:27,897][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:27,898][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:27,899][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:27,900][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:27,901][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:27,902][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:27,902][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:27,903][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:27,904][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:27,905][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:27,905][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:27,906][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:27,908][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:27,908][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:27,909][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:27,909][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:27,910][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:27,910][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:27,910][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:27,912][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:29,827][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 08:38:29,828][__main__][INFO] - Metrics for fold 3: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 08:38:29,893][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 08:38:29,896][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_4
[2025-10-05 08:38:29,898][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_4
[2025-10-05 08:38:29,899][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_4\disc_model_MLPClassifier.pt
[2025-10-05 08:38:29,900][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_4\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 08:38:29,901][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 08:38:29,914][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 08:38:29,930][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 08:38:29,973][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.7777777777777778, 'recall': 0.875, 'f1-score': 0.8235294117647058, 'support': 8.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.8333333333333334, 'f1-score': 0.8695652173913043, 'support': 12.0}, 'accuracy': 0.85, 'macro avg': {'precision': 0.8434343434343434, 'recall': 0.8541666666666667, 'f1-score': 0.8465473145780051, 'support': 20.0}, 'weighted avg': {'precision': 0.8565656565656565, 'recall': 0.85, 'f1-score': 0.851150895140665, 'support': 20.0}}
[2025-10-05 08:38:30,045][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 08:38:30,093][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 08:38:30,094][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:30,095][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 08:38:30,132][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 08:38:30,163][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 08:38:30,164][__main__][INFO] - Creating counterfactual model
[2025-10-05 08:38:30,168][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 08:38:30,916][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 08:38:30,917][__main__][INFO] - Handling counterfactual generation
[2025-10-05 08:38:31,305][__main__][INFO] - Counterfactual search time: 0.3865 seconds
[2025-10-05 08:38:31,310][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_4\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 08:38:31,384][__main__][INFO] - Calculating metrics
[2025-10-05 08:38:31,387][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:31,388][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:31,389][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:31,390][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:31,391][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:31,392][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:31,394][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:31,394][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:31,395][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:31,395][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:31,396][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:31,396][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:31,396][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:31,397][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:31,399][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:31,400][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:31,400][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:31,401][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:31,402][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 08:38:31,403][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 08:38:31,404][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 08:38:33,323][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 08:38:33,324][__main__][INFO] - Metrics for fold 4: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
