[2025-10-05 07:42:59,270][__main__][INFO] - Initializing pipeline
[2025-10-05 07:42:59,272][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 07:42:59,274][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule
[2025-10-05 07:42:59,277][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF
[2025-10-05 07:42:59,278][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\disc_model_MLPClassifier.pt
[2025-10-05 07:42:59,280][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 07:42:59,281][__main__][INFO] - Loading dataset
[2025-10-05 07:42:59,430][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 07:42:59,433][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_0
[2025-10-05 07:42:59,435][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_0
[2025-10-05 07:42:59,436][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_0\disc_model_MLPClassifier.pt
[2025-10-05 07:42:59,437][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_0\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 07:42:59,438][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 07:42:59,467][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 07:43:01,361][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 07:43:01,434][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.8888888888888888, 'recall': 0.8888888888888888, 'f1-score': 0.8888888888888888, 'support': 9.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.9090909090909091, 'f1-score': 0.9090909090909091, 'support': 11.0}, 'accuracy': 0.9, 'macro avg': {'precision': 0.898989898989899, 'recall': 0.898989898989899, 'f1-score': 0.898989898989899, 'support': 20.0}, 'weighted avg': {'precision': 0.9, 'recall': 0.9, 'f1-score': 0.9, 'support': 20.0}}
[2025-10-05 07:43:01,508][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 07:43:01,567][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 07:43:01,567][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:01,570][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:01,611][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 07:43:01,647][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 07:43:01,647][__main__][INFO] - Creating counterfactual model
[2025-10-05 07:43:01,658][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 07:43:02,448][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 07:43:02,449][__main__][INFO] - Handling counterfactual generation
[2025-10-05 07:43:02,941][__main__][INFO] - Counterfactual search time: 0.4905 seconds
[2025-10-05 07:43:02,946][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_0\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 07:43:03,011][__main__][INFO] - Calculating metrics
[2025-10-05 07:43:03,016][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:03,018][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:03,033][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:03,034][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:03,035][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:03,036][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:03,038][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:03,039][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:03,040][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:03,041][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:03,041][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:03,042][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:03,043][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:03,044][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:03,046][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:03,046][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:03,046][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:03,047][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:03,048][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:03,048][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:03,050][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:05,115][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 07:43:05,116][__main__][INFO] - Metrics for fold 0: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 07:43:05,194][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 07:43:05,197][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_1
[2025-10-05 07:43:05,198][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_1
[2025-10-05 07:43:05,199][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_1\disc_model_MLPClassifier.pt
[2025-10-05 07:43:05,200][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_1\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 07:43:05,202][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 07:43:05,213][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 07:43:05,243][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 07:43:05,304][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.7777777777777778, 'recall': 0.875, 'f1-score': 0.8235294117647058, 'support': 8.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.8333333333333334, 'f1-score': 0.8695652173913043, 'support': 12.0}, 'accuracy': 0.85, 'macro avg': {'precision': 0.8434343434343434, 'recall': 0.8541666666666667, 'f1-score': 0.8465473145780051, 'support': 20.0}, 'weighted avg': {'precision': 0.8565656565656565, 'recall': 0.85, 'f1-score': 0.851150895140665, 'support': 20.0}}
[2025-10-05 07:43:05,369][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 07:43:05,432][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 07:43:05,433][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:05,434][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:05,468][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 07:43:05,507][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 07:43:05,508][__main__][INFO] - Creating counterfactual model
[2025-10-05 07:43:05,512][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 07:43:06,226][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 07:43:06,227][__main__][INFO] - Handling counterfactual generation
[2025-10-05 07:43:06,648][__main__][INFO] - Counterfactual search time: 0.4199 seconds
[2025-10-05 07:43:06,654][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_1\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 07:43:06,729][__main__][INFO] - Calculating metrics
[2025-10-05 07:43:06,731][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:06,732][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:06,733][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:06,733][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:06,733][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:06,734][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:06,735][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:06,735][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:06,736][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:06,737][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:06,737][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:06,738][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:06,739][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:06,739][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:06,740][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:06,741][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:06,741][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:06,742][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:06,743][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:06,743][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:06,744][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:08,779][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 07:43:08,780][__main__][INFO] - Metrics for fold 1: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 07:43:08,845][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 07:43:08,849][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_2
[2025-10-05 07:43:08,851][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_2
[2025-10-05 07:43:08,852][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_2\disc_model_MLPClassifier.pt
[2025-10-05 07:43:08,852][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_2\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 07:43:08,853][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 07:43:08,864][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 07:43:08,897][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 07:43:08,961][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.7777777777777778, 'recall': 0.875, 'f1-score': 0.8235294117647058, 'support': 8.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.8333333333333334, 'f1-score': 0.8695652173913043, 'support': 12.0}, 'accuracy': 0.85, 'macro avg': {'precision': 0.8434343434343434, 'recall': 0.8541666666666667, 'f1-score': 0.8465473145780051, 'support': 20.0}, 'weighted avg': {'precision': 0.8565656565656565, 'recall': 0.85, 'f1-score': 0.851150895140665, 'support': 20.0}}
[2025-10-05 07:43:09,031][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 07:43:09,090][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 07:43:09,091][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:09,093][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:09,128][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 07:43:09,159][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 07:43:09,160][__main__][INFO] - Creating counterfactual model
[2025-10-05 07:43:09,164][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 07:43:09,876][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 07:43:09,877][__main__][INFO] - Handling counterfactual generation
[2025-10-05 07:43:10,296][__main__][INFO] - Counterfactual search time: 0.4188 seconds
[2025-10-05 07:43:10,301][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_2\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 07:43:10,340][__main__][INFO] - Calculating metrics
[2025-10-05 07:43:10,341][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:10,342][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:10,342][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:10,342][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:10,342][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:10,343][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:10,344][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:10,344][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:10,344][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:10,344][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:10,344][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:10,346][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:10,346][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:10,346][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:10,347][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:10,347][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:10,347][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:10,348][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:10,348][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:10,348][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:10,349][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:12,237][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 07:43:12,238][__main__][INFO] - Metrics for fold 2: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 07:43:12,285][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 07:43:12,288][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_3
[2025-10-05 07:43:12,290][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_3
[2025-10-05 07:43:12,290][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_3\disc_model_MLPClassifier.pt
[2025-10-05 07:43:12,291][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_3\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 07:43:12,292][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 07:43:12,300][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 07:43:12,328][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 07:43:12,384][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.7777777777777778, 'recall': 0.875, 'f1-score': 0.8235294117647058, 'support': 8.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.8333333333333334, 'f1-score': 0.8695652173913043, 'support': 12.0}, 'accuracy': 0.85, 'macro avg': {'precision': 0.8434343434343434, 'recall': 0.8541666666666667, 'f1-score': 0.8465473145780051, 'support': 20.0}, 'weighted avg': {'precision': 0.8565656565656565, 'recall': 0.85, 'f1-score': 0.851150895140665, 'support': 20.0}}
[2025-10-05 07:43:12,465][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 07:43:12,522][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 07:43:12,523][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:12,525][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:12,552][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 07:43:12,573][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 07:43:12,574][__main__][INFO] - Creating counterfactual model
[2025-10-05 07:43:12,575][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 07:43:13,231][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 07:43:13,232][__main__][INFO] - Handling counterfactual generation
[2025-10-05 07:43:13,615][__main__][INFO] - Counterfactual search time: 0.3815 seconds
[2025-10-05 07:43:13,620][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_3\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 07:43:13,690][__main__][INFO] - Calculating metrics
[2025-10-05 07:43:13,693][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:13,694][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:13,696][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:13,697][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:13,697][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:13,698][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:13,699][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:13,699][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:13,700][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:13,700][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:13,702][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:13,702][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:13,703][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:13,703][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:13,704][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:13,705][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:13,705][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:13,706][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:13,707][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:13,708][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:13,709][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:15,779][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 07:43:15,781][__main__][INFO] - Metrics for fold 3: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 07:43:15,841][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Setting model paths
[2025-10-05 07:43:15,846][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Creatied output folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_4
[2025-10-05 07:43:15,848][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Created save folder C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_4
[2025-10-05 07:43:15,849][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Disc model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_4\disc_model_MLPClassifier.pt
[2025-10-05 07:43:15,850][counterfactuals.pipelines.nodes.helper_nodes][INFO] - Gen model path: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\fold_4\gen_model_EmeryturaModel_relabeled_by_MLPClassifier.pt
[2025-10-05 07:43:15,851][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Creating discriminator model
[2025-10-05 07:43:15,864][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Loading discriminator model (PyTorch Lightning)
[2025-10-05 07:43:15,897][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Evaluating discriminator model
[2025-10-05 07:43:15,959][counterfactuals.pipelines.nodes.disc_model_nodes][INFO] - Discriminator model evaluation results:
 {'0': {'precision': 0.7777777777777778, 'recall': 0.875, 'f1-score': 0.8235294117647058, 'support': 8.0}, '1': {'precision': 0.9090909090909091, 'recall': 0.8333333333333334, 'f1-score': 0.8695652173913043, 'support': 12.0}, 'accuracy': 0.85, 'macro avg': {'precision': 0.8434343434343434, 'recall': 0.8541666666666667, 'f1-score': 0.8465473145780051, 'support': 20.0}, 'weighted avg': {'precision': 0.8565656565656565, 'recall': 0.85, 'f1-score': 0.851150895140665, 'support': 20.0}}
[2025-10-05 07:43:16,023][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Creating generative model
[2025-10-05 07:43:16,079][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Loading generative model (PyTorch Lightning)
[2025-10-05 07:43:16,080][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:16,081][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Evaluating generative model
[2025-10-05 07:43:16,120][counterfactuals.pipelines.nodes.gen_model_nodes][INFO] - Generative model evaluation results:
 train_ll: 0.0000, test_ll: 0.0000
[2025-10-05 07:43:16,155][__main__][INFO] - Filtering out target class data for counterfactual generation
[2025-10-05 07:43:16,156][__main__][INFO] - Creating counterfactual model
[2025-10-05 07:43:16,158][__main__][INFO] - Calculating log_prob_threshold
[2025-10-05 07:43:16,858][__main__][INFO] - log_prob_threshold: -29.4410
[2025-10-05 07:43:16,859][__main__][INFO] - Handling counterfactual generation
[2025-10-05 07:43:17,204][__main__][INFO] - Counterfactual search time: 0.3446 seconds
[2025-10-05 07:43:17,209][__main__][INFO] - Counterfactuals saved to: C:\Users\julia\VSCode\hackyeah2025\machine_learning\models\DataModule\PPCEF\fold_4\counterfactuals_PPCEF_MLPClassifier.csv
[2025-10-05 07:43:17,275][__main__][INFO] - Calculating metrics
[2025-10-05 07:43:17,279][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:17,281][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:17,281][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:17,281][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:17,282][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:17,282][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:17,283][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:17,283][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:17,284][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:17,284][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:17,285][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:17,285][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:17,286][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:17,286][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:17,288][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:17,288][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:17,289][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:17,289][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:17,290][counterfactuals.metrics.distances][INFO] - Calculating combined distance
[2025-10-05 07:43:17,290][counterfactuals.metrics.distances][INFO] - Calculating continuous distance
[2025-10-05 07:43:17,291][counterfactuals.metrics.distances][INFO] - Calculating categorical distance
[2025-10-05 07:43:19,130][__main__][INFO] - Metrics:
{'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
[2025-10-05 07:43:19,131][__main__][INFO] - Metrics for fold 4: {'coverage': np.float64(1.0), 'validity': np.float64(0.16666666666666666), 'actionability': np.float64(0.75), 'sparsity': np.float64(0.25), 'proximity_categorical_hamming': np.float64(0.20159998536174314), 'proximity_categorical_jaccard': np.float64(0.20159998536174314), 'proximity_continuous_manhattan': np.float64(0.20319997072219845), 'proximity_continuous_euclidean': np.float64(0.20159998536174314), 'proximity_continuous_mad': np.float64(0.20524806138128038), 'proximity_l2_jaccard': np.float64(0.20159998536174314), 'proximity_mad_hamming': np.float64(0.20524806138128038), 'prob_plausibility': np.float64(1.0), 'log_density_cf': np.float64(0.3333333333333333), 'log_density_test': np.float64(0.25), 'lof_scores_cf': np.float32(1.0731361), 'lof_scores_test': np.float32(1.073141), 'isolation_forest_scores_cf': np.float64(-0.0022703693666614546), 'isolation_forest_scores_test': np.float64(-0.0023092036625905477)}
